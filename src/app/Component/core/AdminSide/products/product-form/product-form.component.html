
<div class="container">
  <h3 class="mb-3">اضافة منتج</h3>
  <form class="row g-3" [formGroup]="productForm">
    <div class="col-md-5 form-control-div " [ngClass]="{
      sucess: nameproductcontrol?.valid,
      danger: nameproductcontrol?.errors && nameproductcontrol?.touched
    }">
      <label for="nameProduct" class="form-label">اسم المنتج</label>
      <input
        type="text"
        class="form-control our-is-valid"
        id="nameProduct"
        formControlName="nameproduct"
        required
      />
      <i *ngIf="nameproductcontrol?.valid" class="bi bi-check-circle-fill"></i>
      <i *ngIf="nameproductcontrol?.errors && nameproductcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
      <div *ngIf="nameproductcontrol?.errors && nameproductcontrol?.touched" class="alert p-1 mt-2 alert-danger">
      <ng-container *ngIf="nameproductcontrol?.hasError('required')">
        يجب عليك ادخال الاسم
      </ng-container>
      <ng-container  *ngIf="nameproductcontrol?.hasError('minlength')">
        يجب علي الاسم ان تكون اطول من 4 حروف 
      </ng-container>
      <ng-container *ngIf="nameproductcontrol?.hasError('pattern')">
        ادخل الاسم بالغة العربية رجاء
      </ng-container>
    </div>
  </div>
    <div class="col-md-5 form-control-div "  [ngClass]="{
      sucess: categoryproductcontrol?.valid,
      danger: categoryproductcontrol?.errors && categoryproductcontrol?.touched
    }">
        <label class="mb-2" >الفئات</label>
        <ng-multiselect-dropdown 
        formControlName="categoryproduct"
        [placeholder]="'.'"
        [settings]="dropdownSettings"
        [data]="dropdownList"
        [(ngModel)]="selectedItems"
        (onselect)="onItemSelect($event)"
        (onSelectAll)="onSelectAll($event)"
        >
        </ng-multiselect-dropdown>
        <i *ngIf="categoryproductcontrol?.valid" class="bi bi-check-circle-fill"></i>
      <i *ngIf="categoryproductcontrol?.errors && categoryproductcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
      <div *ngIf="categoryproductcontrol?.errors && categoryproductcontrol?.touched" class="alert p-1 mt-2 alert-danger">
      <ng-container *ngIf="categoryproductcontrol?.hasError('required')">
        يجب عليك اختيار فئة
      </ng-container>
      
    </div>
    </div>
    <div class="col-md-10 form-control-div " [ngClass]="{
      sucess: descriptionProductcontrol?.valid,
      danger: descriptionProductcontrol?.errors && descriptionProductcontrol?.touched
    }">
        <label for="productDescription" class="form-label">وصف المنتج</label>
        <textarea formControlName="descriptionProduct" class="form-control" id="productDescription" rows="3" required></textarea>
        <i *ngIf="descriptionProductcontrol?.valid" class="bi bi-check-circle-fill"></i>
        <i *ngIf="descriptionProductcontrol?.errors && descriptionProductcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
        <div *ngIf="descriptionProductcontrol?.errors && descriptionProductcontrol?.touched" class="alert p-1 mt-2 alert-danger">
        <ng-container *ngIf="descriptionProductcontrol?.hasError('required')">
          يجب عليك ادخال وصف المنتج
        </ng-container>
        <ng-container  *ngIf="descriptionProductcontrol?.hasError('minlength')">
          يجب علي الوصف ان تكون اطول من 6 حروف 
        </ng-container>
        <ng-container *ngIf="descriptionProductcontrol?.hasError('pattern')">
          ادخل الوصف بالغة العربية رجاء
        </ng-container>
      </div>
      </div>
    <div class="col-md-10 text-start">
      <button class="btn btn-success rounded-1  px-5" type="submit">اضف</button>
    </div>
  </form>
  <div class="mt-3">
    <div class="col-md-10 text-start">
        <button class="btn btn-dark rounded-1 text-light ms-1 py-1 px-4" (click)="togglePhoto()">الصور <i class="me-2 bi bi-plus-circle-fill"></i></button>
      </div>
    
      <div class="row row-cols-1 row-cols-md-5 ps-md-5 g-4 ms-md-5 mt-2">
        <div *ngFor="let x of imagesColor; let index = index" class="col">
            <div class="card">
                <div [id]="'carouselExampleIndicators' + index" class="carousel slide card-img-top" data-bs-ride="carousel">
                    <div class="carousel-indicators">
                        <button *ngFor="let img of x.imgSrcs; let i = index" type="button" [attr.data-bs-target]="'#carouselExampleIndicators' + index" [attr.data-bs-slide-to]="i" [class.active]="i === 0"></button>
                    </div>
                    <div class="carousel-inner">
                        <div *ngFor="let img of x.imgSrcs; let i = index" class="carousel-item" [class.active]="i === 0">
                            <img [src]="img" class="d-block w-100" style="aspect-ratio: 1; object-fit: cover;">
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <h5 class="card-title" [style.color]="x.colorCode">{{x.Colorname}}</h5>
                </div>
            </div>
        </div>
    </div>
    
  </div>
  <div class="mt-3 col-md-10">
    <div class=" text-start">
        <button class="btn btn-dark rounded-1 text-light ms-1 py-1 px-4" (click)="toggleVarient()">المنتج <i class="me-2 bi bi-plus-circle-fill"></i></button>
      </div>
      <table *ngIf="productVariants.length>0" class="table w-md-75 mt-2">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">اللون</th>
            <th scope="col">الحجم</th>
            <th scope="col">السعر</th>
            <th scope="col">العدد</th>
            <th scope="col">الخصم</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of productVariants, let i = index">
            <th scope="row">{{i}}</th>
            <td>{{item.color}}</td>
            <td>{{item.size}}</td>
            <td>{{item.price}}</td>
            <td>{{item.quantiy}}</td>
            <td>{{item.disceount}}</td>
          </tr>
          
        </tbody>
      </table>
     
    
  </div>
  
</div>

<div id="photoForm" class="add-model model-wrapper">
  <div class="model">
    <div class="model-header">
      <h3>اضافة صور للون</h3>
    </div>
    <div class="model-body">
      <form class="row g-3" [formGroup]="picForm" (submit)="addPhoto($event)">
        <div class="col-7">
          <label for="colorname" class="form-label">اسم اللون</label>
          <input
            formControlName="Colorname"
            type="text"
            class="form-control"
            id="colorname"
            required
          />
        </div>
        <div class="col-4">
          <label for="colorDegree" class="form-label">درجة اللون</label>
          <input
            formControlName="colorCode"
            type="color"
            class="form-control form-control-color"
            id="colorDegree"
            required
          />
        </div>
        <div class="col-12 center">
          <label for="uploadImg" class="form-label uploadImglabel">
            اختر الصور <i class="bi bi-upload"></i
          ></label>
          <input
            type="file"
            class="form-control"
            id="uploadImg"
            required
            accept="image/png, image/jpeg, image/jpg"
            (change)="handleFileInput($event)"
            multiple
          />
          <p *ngIf="uploadedImages.length == 0" id="num-of-files">
            لم يتم رفع صور
          </p>
          <p *ngIf="uploadedImages.length > 0" id="num-of-files">
            عدد الصور {{ uploadedImages.length }}
          </p>
          <div id="images" class="row">
            <div class="col-3 mb-3" *ngFor="let imageSrc of uploadedImages">
              <img [src]="imageSrc" alt="Uploaded Image" class="img-fluid" />
            </div>
          </div>
        </div>

        <div class="col-12 center">
          <button class="btn btn-success m-3" type="submit">اضف</button>
          <button
            class="btn btn-danger m-3"
            type="button"
            (click)="closePhoto()"
          >
            تجاهل
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="VariantForm" class="add-model2 model-wrapper2">
  <div class="model2">
    <div class="model-header2">
        <i (click)="closeVarient()" class="bi bi-x-square-fill"></i>
      <h3>اضافة تفاصيل المنتج</h3>
    </div>
    <div class="model-body2">
      <form
        class="row g-3"
        [formGroup]="productVariantForm"
        (submit)="addVariant($event)"
      >
        <div class="col-6 form-control-div" [ngClass]="{
          sucess: colorvariantcontrol?.valid,
          danger: colorvariantcontrol?.errors && colorvariantcontrol?.touched
        }">
          <label for="colorSelect" class="form-label">اللون</label>
          <select
            formControlName="color"
            class="form-select"
            id="colorSelect"
            required
          >
            <option value="اسود">اسود</option>
            <option value="اخضر">اخضر</option>
            <option value="ازرق">ازرق</option>
          </select>
          <i *ngIf="colorvariantcontrol?.valid" class="bi bi-check-circle-fill"></i>
        <i *ngIf="colorvariantcontrol?.errors && colorvariantcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
        <div *ngIf="colorvariantcontrol?.errors && colorvariantcontrol?.touched" class="alert p-1 mt-2 alert-danger">
        <ng-container *ngIf="colorvariantcontrol?.hasError('required')">
          يجب عليك اختيار لون
        </ng-container>
        
      </div>
        </div>
        <div class="col-6 form-control-div" [ngClass]="{
          sucess: sizevariantcontrol?.valid,
          danger: sizevariantcontrol?.errors && sizevariantcontrol?.touched
        }">
          <label for="colorSelect" class="form-label">الحجم</label>
          <select
            formControlName="size"
            class="form-select"
            id="colorSelect"
            required
          >
            <option value="XL">XL</option>
            <option value="l">L</option>
            <option value="s">S</option>
          </select>
          <i *ngIf="sizevariantcontrol?.valid" class="bi bi-check-circle-fill"></i>
        <i *ngIf="sizevariantcontrol?.errors && sizevariantcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
        <div *ngIf="sizevariantcontrol?.errors && sizevariantcontrol?.touched" class="alert p-1 mt-2 alert-danger">
        <ng-container *ngIf="sizevariantcontrol?.hasError('required')">
          يجب عليك اختيار حجم
        </ng-container>
        
      </div>
        </div>
        <div class="col-md-6 form-control-div" [ngClass]="{
          sucess: pricevariantcontrol?.valid,
          danger: pricevariantcontrol?.errors && pricevariantcontrol?.touched
        }">
          <label for="priceInp" class="form-label">السعر</label>
          <input
            formControlName="price"
            type="number"
            class="form-control"
            id="priceInp"
            required
          />
          <i *ngIf="pricevariantcontrol?.valid" class="bi bi-check-circle-fill"></i>
        <i *ngIf="pricevariantcontrol?.errors && pricevariantcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
        <div *ngIf="pricevariantcontrol?.errors && pricevariantcontrol?.touched" class="alert p-1 mt-2 alert-danger">
        <ng-container *ngIf="pricevariantcontrol?.hasError('required')">
          يجب عليك ادخال السعر
        </ng-container>
        <ng-container *ngIf="pricevariantcontrol?.hasError('min')">
          يجب علي السعر ان يكون اكبر من او يساوي 70 جنيه
        </ng-container>
      </div>
        </div>
        <div class="col-md-6 form-control-div" [ngClass]="{
          sucess: quantiyVariantcontrol?.valid,
          danger: quantiyVariantcontrol?.errors && quantiyVariantcontrol?.touched
        }">
          <label for="quntityInp" class="form-label">العدد</label>
          <input
            formControlName="quantiy"
            type="number"
            class="form-control"
            id="quntityInp"
            required
          />
          <i *ngIf="quantiyVariantcontrol?.valid" class="bi bi-check-circle-fill"></i>
          <i *ngIf="quantiyVariantcontrol?.errors && quantiyVariantcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
          <div *ngIf="quantiyVariantcontrol?.errors && quantiyVariantcontrol?.touched" class="alert p-1 mt-2 alert-danger">
          <ng-container *ngIf="quantiyVariantcontrol?.hasError('required')">
            يجب عليك ادخال الكمية
          </ng-container>
          <ng-container *ngIf="quantiyVariantcontrol?.hasError('min')">
            لا يجب عن الرقم ان يقل عن 5
          </ng-container>
        </div>
        </div>
        <div class="col-md-6 form-control-div" [ngClass]="{
          sucess: disceountvariantcontrol?.valid && disceountvariantcontrol?.touched,
          danger: disceountvariantcontrol?.errors && disceountvariantcontrol?.touched
        }">
          <label for="quntityInp" class="form-label">الخصم</label>
          <input
            formControlName="disceount"
            type="number"
            class="form-control"
            id="quntityInp"
            required
          />
          <i *ngIf="disceountvariantcontrol?.valid && disceountvariantcontrol?.touched" class="bi bi-check-circle-fill"></i>
        <i *ngIf="disceountvariantcontrol?.errors && disceountvariantcontrol?.touched" class="bi bi-exclamation-circle-fill"></i>
        <div *ngIf="disceountvariantcontrol?.errors && disceountvariantcontrol?.touched" class="alert p-1 mt-2 alert-danger">
        
        <ng-container *ngIf="disceountvariantcontrol?.hasError('min') || disceountvariantcontrol?.hasError('max')">
          يجب ان يكون الخصم ما بين %0 ل 25%
        </ng-container>
      </div>
        </div>
        <div class="col-12 center">
          <button class="btn btn-secondary" type="submit">اضف</button>
        </div>
      </form>
    </div>
  </div>
</div>
